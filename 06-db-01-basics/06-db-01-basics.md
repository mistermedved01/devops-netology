# Домашнее задание к занятию 1. «Типы и структура СУБД»

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/virt-11/additional).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определённых данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- электронные чеки в json-виде,
- склады и автомобильные дороги для логистической компании,
- генеалогические деревья,
- кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации,
- отношения клиент-покупка для интернет-магазина.

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Ответ 1

> Электронные чеки в json-виде

**MongoDB — оптимальное решение для работы с JSON форматом.**

Встроенная NoSQL база данных, которая основывается на концепции документоориентированного хранения данных. MongoDB хранит документы в формате JSON, что делает ее идеальным выбором для работы с JSON данными. Она также обеспечивает хорошую производительность и масштабируемость при обработке больших объемов JSON-документов.

**PostgreSQL — сильная альтернатива для работы с JSON данными.**

Реляционная база данных. Одна из самых мощных относительных исторических баз данных с открытым исходным кодом, которая обладает широкой поддержкой JSON и JSONB (бинарной формы). JSONB в PostgreSQL предлагает эффективное хранение и обработку JSON данных, а также поддерживает создание индексов для быстрого доступа к данным.

**CouchDB — эффективный выбор для обработки JSON данных.**

База данных NoSQL, которая специально разработана для работы с данными в формате JSON. Она основана на технологии распределенного хранилища ключ-значение, которая обеспечивает высокую производительность и масштабируемость.

> Склады и автомобильные дороги для логистической компании

**Реляционные базы данных (РСУБД), такие как PostgreSQL или MySQL, как наиболее универсальный и распространенный вариант.**

Преимущества реляционных баз данных включают:

1. Структурированность данных: Реляционные базы данных предоставляют четкую структуру для хранения данных, что подходит для информации о складах и дорогах.

2. Способность управлять сложными отношениями: Если есть несколько типов сущностей (например, склады и дороги) с определенными связями между ними, реляционные базы данных легко моделируют такие отношения.

3. Язык запросов SQL: SQL является мощным языком запросов, что делает легким выполнение сложных запросов для анализа данных.

4. Поддержка транзакций: Реляционные базы данных обеспечивают поддержку транзакций, что важно для целостности данных в логистической системе.

5. Широкая поддержка и сообщество: PostgreSQL и MySQL - это открытые и широко используемые РСУБД с активными сообществами, что обеспечивает надежность и разнообразие инструментов.

> Генеалогические деревья

Графовые базы данных хорошо подходят для моделирования и хранения связей между данными, что делает их идеальным выбором для представления генеалогических отношений.

В графовой базе данных каждый человек может быть представлен узлом, а отношения между людьми (родственные связи) - ребрами графа. Это позволяет эффективно организовывать и обрабатывать данные о родственных отношениях, уровнях предков и потомков.

Примеры графовых баз данных включают: **Neo4j, Amazon Neptune, или ArangoDB.** 

> Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации

**In-memory database (IMDB) – это вид БД, который хранит все свои данные в оперативной памяти компьютера, а не на диске, как в традиционных базах данных. Это позволяет существенно ускорить операции чтения и записи данных.**

**Redis (Remote DIctionary Server)** 

Высокопроизводительная система хранения данных в памяти с открытым исходным кодом, которая поддерживает различные типы данных, включая строки, списки, множества, хеш-таблицы и многое другое. Он предоставляет высокую скорость доступа к данным, так как данные хранятся в оперативной памяти и могут быть быстро считаны и записаны. Вот некоторые из преимуществ Redis:

1. Высокая производительность:
Redis предназначен для быстрого доступа к данным, и он делает это очень хорошо. Он может обслуживать тысячи запросов в секунду, что делает его отличным выбором для кеширования данных и ускорения процесса доступа к ним.

2. Поддержка разнообразных типов данных:
Redis не ограничивается простыми строками и может хранить разные типы данных, включая списки, множества, хеш-таблицы и даже геопространственные данные.

3. Постоянное хранение данных:
Redis также позволяет сохранять данные на диск, обеспечивая сохранность данных между перезапусками.

4. Возможность репликации и кластеризации:
Redis поддерживает репликацию данных для обеспечения отказоустойчивости, а также кластеризацию для масштабирования горизонтально.

5. Богатый функционал:
Redis имеет множество функций, таких как транзакции, внешние модули и публикация/подписка на события.

**Memcached**

Также система кеширования данных, которая используется для ускорения доступа к данным. Он также хранит данные в оперативной памяти, но у него более узкий функционал по сравнению с Redis. Вот некоторые из преимуществ Memcached:

1. Простота и быстрота:
Memcached разработан с акцентом на простоте и скорости. Он обеспечивает высокую производительность и быстродействие для операций чтения и записи в кеш.

2. Распределенная архитектура:
Memcached позволяет создавать кластеры для распределения данных между несколькими серверами, что обеспечивает отказоустойчивость и масштабируемость.

3. Поддержка многих языков программирования:
Memcached имеет клиентские библиотеки для множества языков программирования, что делает его доступным для широкого круга разработчиков.

**Отличия между Redis и Memcached**

Помимо преимуществ, у Redis и Memcached есть и некоторые отличия:

1. Типы данных:
Redis поддерживает более широкий спектр типов данных и предоставляет богатый функционал, в то время как Memcached ограничивается простыми строками.

2. Сохранность данных:
Redis предоставляет возможность сохранять данные на диск, в то время как Memcached хранит данные только в оперативной памяти и не гарантирует их сохранность между перезапусками.

3. Экосистема:
Redis имеет богатую экосистему с поддержкой модулей и инструментов, в то время как Memcached более прост и ограничен в своей функциональности.

**В каких случаях использовать Redis и Memcached?**

Выбор между Redis и Memcached зависит от конкретных потребностей проекта:

- Используйте Redis, если вам нужна богатая функциональность, поддержка разнообразных типов данных и возможность сохранения данных на диск. Он отлично подходит для приложений, которые требуют сложного кеширования и обработки данных.

- Используйте Memcached, если вы ищете простое и быстрое решение для кеширования данных и не требуете сохранности данных между перезапусками. Он может быть идеальным выбором для приложений, где скорость доступа к данным имеет первостепенное значение.

>  Отношения клиент-покупка для интернет-магазина

Обычно используют реляционные базы данных. Это связано с тем, что реляционные базы данных хорошо подходят для моделирования структурированных данных с явными связями между различными сущностями.

## Задача 2

Вы создали распределённое высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт — это отдельная реализация вашей системы и для каждого пункта нужно привести классификацию):

- данные записываются на все узлы с задержкой до часа (асинхронная запись);
- при сетевых сбоях система может разделиться на 2 раздельных кластера;
- система может не прислать корректный ответ или сбросить соединение.

Согласно PACELC-теореме как бы вы классифицировали эти реализации?

## Ответ 2

Согласно CAP-теореме, системы распределённых данных не могут одновременно обеспечить Consistency (Согласованность), Availability (Доступность) и Partition tolerance (Устойчивость к разделению). Поэтому для каждой из реализаций можно предложить следующую классификацию:

1. Данные записываются на все узлы с задержкой до часа (асинхронная запись):

- Consistency (C): Низкая. Задержка до часа при записи данных означает, что не все узлы будут мгновенно обновлены, что может привести к временным различиям в данных.

- Availability (A): Высокая. Поскольку система позволяет асинхронную запись на все узлы, доступность данных должна быть высокой, даже при возможных сбоях в отдельных узлах.

- Partition tolerance (P): Высокая. Так как система позволяет асинхронную запись на все узлы, она вероятно устойчива к разделению.

Классификация по PACELC-теореме: AP (Доступность и Устойчивость к разделению с ослабленной согласованностью).

2. При сетевых сбоях система может разделиться на 2 раздельных кластера:

- Consistency (C): Зависит от того, как обрабатываются разделения. Если система разделяется, то согласованность будет нарушена.

- Availability (A): Может быть низкой в случае разделения, но высокой в пределах каждого кластера.

- Partition tolerance (P): Высокая. Система способна функционировать при разделении.

Классификация по PACELC-теореме: CP (Согласованность и Устойчивость к разделению с ослабленной доступностью).

3. Система может не прислать корректный ответ или сбросить соединение:

- Consistency (C): Зависит от того, как обрабатываются ошибки. Если система может вернуть некорректный ответ или сбросить соединение, то согласованность может быть нарушена.

- Availability (A): Низкая, если система может сбросить соединение или вернуть некорректный ответ.

- Partition tolerance (P): Высокая. Система, вероятно, устойчива к разделению.

Классификация по PACELC-теореме: CP (Согласованность и Устойчивость к разделению с ослабленной доступностью).

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

## Ответ 3

Принципы BASE (Basically Available, Soft state, Eventually consistent) и ACID (Atomicity, Consistency, Isolation, Durability) представляют различные подходы к построению систем управления данными, и они имеют разные цели. Обычно они противоположны друг другу, и их применение зависит от требований конкретной системы.

ACID ориентирован на обеспечение надежности и целостности данных. Системы, использующие принципы ACID, стремятся к тому, чтобы транзакции были атомарными, консистентными, изолированными и долговечными. Этот подход подходит для систем, где важна точность и непрерывность данных, таких как банковские системы или системы управления инвентарем.

BASE, с другой стороны, фокусируется на обеспечении более высокой доступности и масштабируемости за счет уменьшения требований к согласованности данных. Системы, использующие принципы BASE, могут временно нарушать консистентность данных, но обеспечивают их согласованность в конечном итоге. Этот подход подходит для распределенных систем, где важны высокая доступность и горизонтальное масштабирование.

В некоторых случаях системы могут комбинировать элементы обоих подходов в зависимости от конкретных требований для различных компонентов. Это известно как гибридный подход. Например, в распределенных базах данных часто используется комбинация ACID для локальных транзакций и BASE для глобальной масштабируемости и доступности. Однако, важно учитывать, что реализация гибридных систем может быть сложной и требует внимательного проектирования и согласования.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни,
- реакция на истечение таймаута.

Вы слышали о key-value-хранилище, которое имеет механизм Pub/Sub. 
Что это за система? Какие минусы выбора этой системы?

### Ответ 4

Описанные требования вполне подходят для реализации с использованием key-value-хранилища с механизмом Pub/Sub (публикация-подписка). Примером такой системы может быть Redis, который широко используется в подобных сценариях.

**Key-value-хранилище с механизмом Pub/Sub:**

1. Key-Value Хранилище (например, Redis): Это база данных, которая хранит данные в формате ключ-значение, где каждому ключу соответствует некоторое значение.

2. Механизм Pub/Sub (Публикация-Подписка): Это позволяет клиентам подписываться на события (публикации) и получать уведомления, когда происходят изменения в данных, связанные с определенными ключами.

Преимущества использования такой системы:

1. Реакция на изменения в реальном времени: Pub/Sub позволяет вашему приложению реагировать на изменения данных мгновенно, без необходимости постоянно опрашивать хранилище.

2. Простота интеграции: Redis, как key-value-хранилище с Pub/Sub, предоставляет простой и эффективный способ реализации данной функциональности.

3. Гибкость и масштабируемость: Redis обладает высокой производительностью и может масштабироваться горизонтально при необходимости.

Минусы использования такой системы:

1. Ограниченность по функциональности: Key-value-хранилища с Pub/Sub обычно предоставляют базовые возможности, и они могут быть не подходящими для сложных сценариев с обширными требованиями к запросам или транзакциям.

2. Необходимость в дополнительной обработке ошибок: При использовании Pub/Sub необходимо учитывать возможность потери сообщений или дублирования событий. Дополнительные меры безопасности и обработки ошибок могут потребоваться для обеспечения надежности системы.

3. Сложности в обеспечении согласованности данных: В системах с Pub/Sub может возникнуть сложность в обеспечении согласованности данных между различными частями системы, особенно при масштабировании.
