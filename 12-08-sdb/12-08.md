# Домашнее задание к занятию "`Резервное копирование баз данных`" - `Потапов Василий`

## Задание 1. Резервное копирование

Кейс

Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

Необходимо описать, какие варианты резервного копирования подходят в случаях:

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

Приведите ответ в свободной форме.

## Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

Приведите ответ в свободной форме.

## Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

Приведите ответ в свободной форме.

## Ответ 1

#### 1.1.

Полное копирование (Full Backup) — это процесс создания копии абсолютно всех данных оригинала, независимо от времени и условий их изменений.

#### 1.2. 

Инкрементное копирование (Incremental Backup) - этот вид резервного копирования гораздо экономичнее и быстрее, чем полный бэкап, поскольку в этом процессе копируются только те файлы, которые изменились со времени предыдущего резервного копирования. 

## Ответ 2

1 Команда резервирования базы данных с использованием `pg_dump`:

`pg_dump -U <имя_пользователя> -d <имя_базы_данных> -f <путь_к_файлу_резерва>`

Пример команды резервирования базы данных mydb в файл backup.sql:

`pg_dump -U myuser -d mydb -f /path/to/backup.sql`

2 Команда восстановления базы данных с использованием `pg_restore`:

`pg_restore -U <имя_пользователя> -d <имя_базы_данных> <файл_резерва>`

Пример команды восстановления базы данных mydb из файла backup.sql:

`pg_restore -U myuser -d mydb /path/to/backup.sql`

## Ответ 3

`mysqldump --single-transaction --flush-logs --master-data=2 --databases your_database_name > backup_file.sql`

Где:

mysqldump - утилита MySQL для создания резервных копий.

single-transaction - выполняет резервное копирование в рамках одной транзакции, что предотвращает блокировку таблиц.

flush-logs - обязательная опция при инкрементном резервном копировании, которая заставляет MySQL записывать все транзакции в журнал транзакций (лог бинарных журналов).

master-data=2 - эта опция добавляет в комментарии к файлу резервной копии идентификатор бинарного журнала и положение бинарного журнала перед выполнением команды mysqldump, что позволяет точечное восстановление с помощью бинарных журналов.

databases - указывает, что будет создана резервная копия одной или нескольких баз данных. Вместо your_database_name укажите имя вашей базы данных или несколько баз через пробел.

backup_file.sql - перенаправляет вывод команды mysqldump в файл backup_file.sql, который будет содержать резервную копию базы данных.
